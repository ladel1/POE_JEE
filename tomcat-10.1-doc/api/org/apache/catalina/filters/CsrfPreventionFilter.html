<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>CsrfPreventionFilter (Apache Tomcat 10.1.11 API Documentation)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CsrfPreventionFilter (Apache Tomcat 10.1.11 API Documentation)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>Apache Tomcat 10.1.11</b></div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.apache.catalina.filters</a></div>
<h2 title="Class CsrfPreventionFilter" class="title">Class CsrfPreventionFilter</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="FilterBase.html" title="class in org.apache.catalina.filters">org.apache.catalina.filters.FilterBase</a></li>
<li>
<ul class="inheritance">
<li><a href="CsrfPreventionFilterBase.html" title="class in org.apache.catalina.filters">org.apache.catalina.filters.CsrfPreventionFilterBase</a></li>
<li>
<ul class="inheritance">
<li>org.apache.catalina.filters.CsrfPreventionFilter</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/Filter.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">Filter</a></code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">CsrfPreventionFilter</span>
extends <a href="CsrfPreventionFilterBase.html" title="class in org.apache.catalina.filters">CsrfPreventionFilterBase</a></pre>
<div class="block">Provides basic CSRF protection for a web application. The filter assumes that:
 <ul>
 <li>The filter is mapped to /*</li>
 <li><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletResponse.html?is-external=true#encodeRedirectURL(java.lang.String)" title="class or interface in jakarta.servlet.http" class="externalLink"><code>HttpServletResponse.encodeRedirectURL(String)</code></a> and <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletResponse.html?is-external=true#encodeURL(java.lang.String)" title="class or interface in jakarta.servlet.http" class="externalLink"><code>HttpServletResponse.encodeURL(String)</code></a> are used
 to encode all URLs returned to the client
 </ul></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="CsrfPreventionFilter.CsrfResponseWrapper.html" title="class in org.apache.catalina.filters">CsrfPreventionFilter.CsrfResponseWrapper</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="CsrfPreventionFilter.LruCache.html" title="class in org.apache.catalina.filters">CsrfPreventionFilter.LruCache</a>&lt;<a href="CsrfPreventionFilter.LruCache.html" title="type parameter in CsrfPreventionFilter.LruCache">T</a>&gt;</span></code></th>
<td class="colLast">
<div class="block">Despite its name, this is a FIFO cache not an LRU cache.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters">CsrfPreventionFilter.NonceCache</a>&lt;<a href="CsrfPreventionFilter.NonceCache.html" title="type parameter in CsrfPreventionFilter.NonceCache">T</a>&gt;</span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.org.apache.catalina.filters.FilterBase">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;org.apache.catalina.filters.<a href="FilterBase.html" title="class in org.apache.catalina.filters">FilterBase</a></h3>
<code><a href="FilterBase.html#sm">sm</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">CsrfPreventionFilter</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>protected <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters">CsrfPreventionFilter.NonceCache</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createNonceCache(jakarta.servlet.http.HttpServletRequest,jakarta.servlet.http.HttpSession)">createNonceCache</a></span>&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request,
                <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpSession.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpSession</a>&nbsp;session)</code></th>
<td class="colLast">
<div class="block">Create a new <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters"><code>CsrfPreventionFilter.NonceCache</code></a> and store in the <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpSession.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink"><code>HttpSession</code></a>.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#doFilter(jakarta.servlet.ServletRequest,jakarta.servlet.ServletResponse,jakarta.servlet.FilterChain)">doFilter</a></span>&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletRequest.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletRequest</a>&nbsp;request,
        <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletResponse.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletResponse</a>&nbsp;response,
        <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/FilterChain.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">FilterChain</a>&nbsp;chain)</code></th>
<td class="colLast">
<div class="block">The <code>doFilter</code> method of the Filter is called by the container each time a request/response pair is
 passed through the chain due to a client request for a resource at the end of the chain.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>protected <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters">CsrfPreventionFilter.NonceCache</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getNonceCache(jakarta.servlet.http.HttpServletRequest,jakarta.servlet.http.HttpSession)">getNonceCache</a></span>&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request,
             <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpSession.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpSession</a>&nbsp;session)</code></th>
<td class="colLast">
<div class="block">Obtain the <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters"><code>CsrfPreventionFilter.NonceCache</code></a> associated with the request and/or session.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#init(jakarta.servlet.FilterConfig)">init</a></span>&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/FilterConfig.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">FilterConfig</a>&nbsp;filterConfig)</code></th>
<td class="colLast">
<div class="block">Iterates over the configuration parameters and either logs a warning, or throws an exception for any parameter
 that does not have a matching setter in this filter.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setEntryPoints(java.lang.String)">setEntryPoints</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;entryPoints)</code></th>
<td class="colLast">
<div class="block">Entry points are URLs that will not be tested for the presence of a valid nonce.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setNonceCacheSize(int)">setNonceCacheSize</a></span>&#8203;(int&nbsp;nonceCacheSize)</code></th>
<td class="colLast">
<div class="block">Sets the number of previously issued nonces that will be cached on a LRU basis to support parallel requests,
 limited use of the refresh and back in the browser and similar behaviors that may result in the submission of a
 previous nonce rather than the current one.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setNonceRequestParameterName(java.lang.String)">setNonceRequestParameterName</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;parameterName)</code></th>
<td class="colLast">
<div class="block">Sets the request parameter name to use for CSRF nonces.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#skipNonceCheck(jakarta.servlet.http.HttpServletRequest)">skipNonceCheck</a></span>&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#skipNonceGeneration(jakarta.servlet.http.HttpServletRequest)">skipNonceGeneration</a></span>&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request)</code></th>
<td class="colLast">
<div class="block">Determines whether a nonce should be created.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.org.apache.catalina.filters.CsrfPreventionFilterBase">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.apache.catalina.filters.<a href="CsrfPreventionFilterBase.html" title="class in org.apache.catalina.filters">CsrfPreventionFilterBase</a></h3>
<code><a href="CsrfPreventionFilterBase.html#generateNonce(jakarta.servlet.http.HttpServletRequest)">generateNonce</a>, <a href="CsrfPreventionFilterBase.html#getDenyStatus()">getDenyStatus</a>, <a href="CsrfPreventionFilterBase.html#getLogger()">getLogger</a>, <a href="CsrfPreventionFilterBase.html#getRequestedPath(jakarta.servlet.http.HttpServletRequest)">getRequestedPath</a>, <a href="CsrfPreventionFilterBase.html#isConfigProblemFatal()">isConfigProblemFatal</a>, <a href="CsrfPreventionFilterBase.html#setDenyStatus(int)">setDenyStatus</a>, <a href="CsrfPreventionFilterBase.html#setRandomClass(java.lang.String)">setRandomClass</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.jakarta.servlet.Filter">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;jakarta.servlet.<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/Filter.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">Filter</a></h3>
<code><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/Filter.html?is-external=true#destroy()" title="class or interface in jakarta.servlet" class="externalLink">destroy</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CsrfPreventionFilter</h4>
<pre>public&nbsp;CsrfPreventionFilter()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="setEntryPoints(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setEntryPoints</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setEntryPoints&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;entryPoints)</pre>
<div class="block">Entry points are URLs that will not be tested for the presence of a valid nonce. They are used to provide a way
 to navigate back to a protected application after navigating away from it. Entry points will be limited to HTTP
 GET requests and should not trigger any security sensitive actions.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>entryPoints</code> - Comma separated list of URLs to be configured as entry points.</dd>
</dl>
</li>
</ul>
<a id="setNonceCacheSize(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setNonceCacheSize</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setNonceCacheSize&#8203;(int&nbsp;nonceCacheSize)</pre>
<div class="block">Sets the number of previously issued nonces that will be cached on a LRU basis to support parallel requests,
 limited use of the refresh and back in the browser and similar behaviors that may result in the submission of a
 previous nonce rather than the current one. If not set, the default value of 5 will be used.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nonceCacheSize</code> - The number of nonces to cache</dd>
</dl>
</li>
</ul>
<a id="setNonceRequestParameterName(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setNonceRequestParameterName</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setNonceRequestParameterName&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;parameterName)</pre>
<div class="block">Sets the request parameter name to use for CSRF nonces.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>parameterName</code> - The request parameter name to use for CSRF nonces.</dd>
</dl>
</li>
</ul>
<a id="init(jakarta.servlet.FilterConfig)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;init&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/FilterConfig.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">FilterConfig</a>&nbsp;filterConfig)
          throws <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletException.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="FilterBase.html#init(jakarta.servlet.FilterConfig)">FilterBase</a></code></span></div>
<div class="block">Iterates over the configuration parameters and either logs a warning, or throws an exception for any parameter
 that does not have a matching setter in this filter.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/Filter.html?is-external=true#init(jakarta.servlet.FilterConfig)" title="class or interface in jakarta.servlet" class="externalLink">init</a></code>&nbsp;in interface&nbsp;<code><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/Filter.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">Filter</a></code></dd>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="CsrfPreventionFilterBase.html#init(jakarta.servlet.FilterConfig)">init</a></code>&nbsp;in class&nbsp;<code><a href="CsrfPreventionFilterBase.html" title="class in org.apache.catalina.filters">CsrfPreventionFilterBase</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>filterConfig</code> - The configuration information associated with the filter instance being initialised</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletException.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletException</a></code> - if <a href="FilterBase.html#isConfigProblemFatal()"><code>FilterBase.isConfigProblemFatal()</code></a> returns <code>true</code> and a configured parameter does
                              not have a matching setter</dd>
</dl>
</li>
</ul>
<a id="doFilter(jakarta.servlet.ServletRequest,jakarta.servlet.ServletResponse,jakarta.servlet.FilterChain)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doFilter</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;doFilter&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletRequest.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletRequest</a>&nbsp;request,
                     <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletResponse.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletResponse</a>&nbsp;response,
                     <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/FilterChain.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">FilterChain</a>&nbsp;chain)
              throws <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a>,
                     <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletException.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/Filter.html?is-external=true#doFilter(jakarta.servlet.ServletRequest,jakarta.servlet.ServletResponse,jakarta.servlet.FilterChain)" title="class or interface in jakarta.servlet" class="externalLink">jakarta.servlet.Filter</a></code></span></div>
<div class="block">The <code>doFilter</code> method of the Filter is called by the container each time a request/response pair is
 passed through the chain due to a client request for a resource at the end of the chain. The FilterChain passed
 in to this method allows the Filter to pass on the request and response to the next entity in the chain.
 <p>
 A typical implementation of this method would follow the following pattern:- <br>
 1. Examine the request<br>
 2. Optionally wrap the request object with a custom implementation to filter content or headers for input
 filtering <br>
 3. Optionally wrap the response object with a custom implementation to filter content or headers for output
 filtering <br>
 4. a) <strong>Either</strong> invoke the next entity in the chain using the FilterChain object
 (<code>chain.doFilter()</code>), <br>
 4. b) <strong>or</strong> not pass on the request/response pair to the next entity in the filter chain to block
 the request processing<br>
 5. Directly set headers on the response after invocation of the next entity in the filter chain.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - The request to process</dd>
<dd><code>response</code> - The response associated with the request</dd>
<dd><code>chain</code> - Provides access to the next filter in the chain for this filter to pass the request and response
                     to for further processing</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code> - if an I/O error occurs during this filter's processing of the request</dd>
<dd><code><a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/ServletException.html?is-external=true" title="class or interface in jakarta.servlet" class="externalLink">ServletException</a></code> - if the processing fails for any other reason</dd>
</dl>
</li>
</ul>
<a id="skipNonceCheck(jakarta.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>skipNonceCheck</h4>
<pre class="methodSignature">protected&nbsp;boolean&nbsp;skipNonceCheck&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request)</pre>
</li>
</ul>
<a id="skipNonceGeneration(jakarta.servlet.http.HttpServletRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>skipNonceGeneration</h4>
<pre class="methodSignature">protected&nbsp;boolean&nbsp;skipNonceGeneration&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request)</pre>
<div class="block">Determines whether a nonce should be created. This method is provided primarily for the benefit of sub-classes
 that wish to customise this behaviour.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - The request that triggered the need to potentially create the nonce.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if a nonce should be created, otherwise <code>false</code></dd>
</dl>
</li>
</ul>
<a id="createNonceCache(jakarta.servlet.http.HttpServletRequest,jakarta.servlet.http.HttpSession)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createNonceCache</h4>
<pre class="methodSignature">protected&nbsp;<a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters">CsrfPreventionFilter.NonceCache</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;createNonceCache&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request,
                                                                   <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpSession.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpSession</a>&nbsp;session)</pre>
<div class="block">Create a new <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters"><code>CsrfPreventionFilter.NonceCache</code></a> and store in the <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpSession.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink"><code>HttpSession</code></a>. This method is provided primarily for the
 benefit of sub-classes that wish to customise this behaviour.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - The request that triggered the need to create the nonce cache. Unused by the default
                    implementation.</dd>
<dd><code>session</code> - The session associated with the request.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A newly created <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters"><code>CsrfPreventionFilter.NonceCache</code></a></dd>
</dl>
</li>
</ul>
<a id="getNonceCache(jakarta.servlet.http.HttpServletRequest,jakarta.servlet.http.HttpSession)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getNonceCache</h4>
<pre class="methodSignature">protected&nbsp;<a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters">CsrfPreventionFilter.NonceCache</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&gt;&nbsp;getNonceCache&#8203;(<a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpServletRequest.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpServletRequest</a>&nbsp;request,
                                                                <a href="https://jakarta.ee/specifications/platform/10/apidocs/jakarta/servlet/http/HttpSession.html?is-external=true" title="class or interface in jakarta.servlet.http" class="externalLink">HttpSession</a>&nbsp;session)</pre>
<div class="block">Obtain the <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters"><code>CsrfPreventionFilter.NonceCache</code></a> associated with the request and/or session. This method is provided primarily for
 the benefit of sub-classes that wish to customise this behaviour.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - The request that triggered the need to obtain the nonce cache. Unused by the default
                    implementation.</dd>
<dd><code>session</code> - The session associated with the request.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The <a href="CsrfPreventionFilter.NonceCache.html" title="interface in org.apache.catalina.filters"><code>CsrfPreventionFilter.NonceCache</code></a> currently associated with the request and/or session</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>Apache Tomcat 10.1.11</b></div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2000-2023 Apache Software Foundation. All Rights Reserved.</small></p>
</footer>
</body>
</html>
